<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista Spesa</title>
</head>
<body>
    <h1>Lista spesa</h1>
    
    <!-- Pulsante per generare prodotti casuali -->
    <button onclick="generaProdotti()">Genera Prodotti Casuali</button>
    
    <!-- campo per inserire il prodotto -->
    <input type="text" id="item-input" placeholder="Inserisci prodotto">
    
    <!-- campo per inserire la quantità -->
    <input type="number" id="quantity-input" placeholder="Inserisci quantità">

    <!-- Categorie prodotti -->
    <select id="category-select">
        <option value="frutta">Frutta</option>
        <option value="verdura">Verdura</option>
        <option value="altro">Altro</option>
    </select>


    
    <button onclick="aggiungieElemento()">Aggiungi</button>
    
    <!-- Lista della spesa -->
    <div id="shopping-list"></div>

    <script>
        // Array di nomi di prodotti
        const nomiProdotti = ["Pane", "Latte", "Uova", "Mela", "Banana", "Carne", "Formaggio"];

        // Dichiarazione dell'array per la lista della spesa
        let listaSpesa = [];

        // Funzione per generare prodotti con ID e quantità casuale
        function generaProdotti() {
            let prodottiCasuali = []; // Array temporaneo per i prodotti casuali
            
            // Creiamo 5 prodotti casuali
            for (let i = 0; i < 5; i++) {
                let prodotto = {
                    id: listaSpesa.length + 1,  // ID progressivo 
                    nome: nomiProdotti[Math.floor(Math.random() * nomiProdotti.length)], // Nome casuale da nomiProdotti
                    quantita: Math.floor(Math.random() * 5) + 1,  // Quantità casuale tra 1 e 5
                    categoria: ['frutta', 'verdura', 'altro'][Math.floor(Math.random() * 3)] // Categoria casuale
                };
                prodottiCasuali.push(prodotto);  // Aggiungiamo il prodotto all'array temporaneo
            }
            
            // Aggiungi i prodotti casuali alla lista della spesa
            listaSpesa = listaSpesa.concat(prodottiCasuali);
            
            // Visualizziamo la lista aggiornata
            aggiornaLista();
        }

        // Funzione per aggiungere l'elemento con la quantità alla lista
        function aggiungieElemento() {
            let itemInput = document.getElementById('item-input');
            let quantityInput = document.getElementById('quantity-input');
            let categorySelect = document.getElementById('category-select');
            
            let valoreProdotto = itemInput.value.trim();
            let valoreQuantita = Number(quantityInput.value);
            let categoriaSelezionata = categorySelect.value;


            // Controllo se il prodotto e la quantità sono validi
            if (valoreProdotto !== '' && valoreQuantita !== '' && !isNaN(valoreQuantita) && valoreQuantita > 0) {
                let prodotto = {
                    id: listaSpesa.length + 1,  // ID progressivo, in base alla lunghezza attuale della lista
                    nome: valoreProdotto,
                    quantita: valoreQuantita,
                    categoria: categoriaSelezionata
                };
                listaSpesa.push(prodotto);

                // Reset dei campi di input
                itemInput.value = '';
                quantityInput.value = '';
                categorySelect.value = 'frutta'; // Ripristina la selezione della categoria a "frutta"

                // Aggiorna la lista
                aggiornaLista();
            } else {
                alert('Inserisci un prodotto valido e una quantità.');
            }
        }

         // Funzione per aggiornare la lista della spesa nell'HTML
        function aggiornaLista() {
    let ul = document.getElementById('shopping-list');
    // Prende il contenitore della lista della spesa dall'HTML
    ul.innerHTML = '';

    let categorie = ['frutta', 'verdura', 'altro'];
    for (let categoria of categorie) {
        // Filtra i prodotti della lista che appartengono a questa categoria
        let prodottiPerCategoria = listaSpesa.filter(p => p.categoria === categoria);
        
        // Se ci sono prodotti in questa categoria
        if (prodottiPerCategoria.length > 0) {
            // Crea un'intestazione per la categoria (h3)
            let categoriaHeader = document.createElement('h3');
            // Scrive il nome della categoria con la prima lettera maiuscola
            categoriaHeader.textContent = categoria.charAt(0).toUpperCase() + categoria.slice(1);
            ul.appendChild(categoriaHeader);

            let categoriaUl = document.createElement('ul');
            for (let prodotto of prodottiPerCategoria) {
                let li = document.createElement('li');
                li.textContent = `ID: ${prodotto.id} - Prodotto: ${prodotto.nome} -: ${prodotto.quantita}`;

                let deleteButton = document.createElement('button');
                deleteButton.style.marginLeft = '10px';
                deleteButton.textContent = 'Delete';
                deleteButton.onclick = function() {
                    // Rimuove il prodotto dalla lista usando l'ID
                    listaSpesa = listaSpesa.filter(p => p.id !== prodotto.id);
                    aggiornaLista();
                };

                // Pulsante per segnare come acquistato
                let boughtButton = document.createElement('button');
                boughtButton.style.marginLeft = '10px';
                boughtButton.textContent = 'Acquistato';
                boughtButton.onclick = function() {
                    // Aggiunge/rimuove la classe "acquistato" al <li>
                    li.classList.toggle('acquistato');
                };

                // Aggiunge il pulsante delete all'elemento <li>
                li.appendChild(deleteButton);
                li.appendChild(boughtButton);
                // Aggiunge il <li> all'<ul> della categoria
                categoriaUl.appendChild(li);
            }
            // Aggiunge l'<ul> con tutti i prodotti della categoria alla lista principal
            ul.appendChild(categoriaUl);
        }
    }
}
    </script>
</body>
</html>
